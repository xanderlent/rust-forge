<!DOCTYPE html>
<!-- Page last generated 2019-03-06 13:48:16 +0000 -->
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Beta Backporting &middot; The Rust Programming Language</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Rust, Rust programming language, rustlang, rust-lang, Mozilla Rust">
    <meta name="description" content="A systems programming language that runs blazingly fast, prevents segfaults, and guarantees thread safety.">
    <link rel="stylesheet" href="/css/bootstrap.css">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/forge.css">
    <link rel="stylesheet" href="/rust-forge/css/bootstrap.css">
    <link rel="stylesheet" href="/rust-forge/css/style.css">
    <link rel="stylesheet" href="/rust-forge/css/forge.css">
  </head>

  <body class="container">

    <header>

    <ul class="row menu">
      <li class="col-xs-12 col-md-2">
        <a href="index.html">
	  <!-- FIXME: absolute urls -->
          <img class="img-responsive" src="https://www.rust-lang.org/logos/rust-logo-blk.svg" onerror="this.src='https://www.rust-lang.org/logos/rust-logo-256x256-blk.png'" height="128" width="128" alt="Rust logo" />
        </a>
      </li>
      <li class="col-xs-12 col-md-6 menu">
	<h1>Rust Forge</h1>
      </li>
    </ul>
    </header>

    <div class="content"><h1 id="beta-backporting">Beta Backporting</h1>

<p>There’s a steady trickle of patches that need to be ported to the beta
branch. Only a few people are even aware of the process, but this is
actually something anybody can do.</p>

<h2 id="backporting-in-rust-langrust">Backporting in <code class="highlighter-rouge">rust-lang/rust</code></h2>

<p>When somebody identifies a PR that should be backported to beta they
tag it
<a href="https://github.com/rust-lang/rust/pulls?q=is%3Apr+is%3Aclosed+label%3Abeta-nominated"><code class="highlighter-rouge">beta-nominated</code></a>. That
means they want one of the teams to evaluate whether the patch should
be backported. I also suggest applying the <code class="highlighter-rouge">I-nominated</code> and and a
<code class="highlighter-rouge">T-</code> (team) tag as appropriate: that’ll <em>really</em> get their
attention. Anybody with triage access is free to make these
tags. Backports are mostly done to fix regressions. If the team thinks
it should be backported they’ll then additionally tag it
<a href="https://github.com/rust-lang/rust/pulls?q=is%3Apr+is%3Aclosed+label%3Abeta-accepted"><code class="highlighter-rouge">beta-accepted</code></a>.</p>

<p>At that point the PR is ready to be backported. So the list of patches
ready for a backport is those tagged <a href="https://github.com/rust-lang/rust/pulls?q=is%3Apr+label%3Abeta-accepted+is%3Aclosed+label%3Abeta-nominated">both <code class="highlighter-rouge">beta-nominated</code> and
<code class="highlighter-rouge">beta-accepted</code></a>.</p>

<p>So now somebody needs to go through those PR’s and cherry-pick their
commits to the beta branch. Those cherry-picks are then submitted as a
PR <em>against the beta branch</em>, with a title started with <code class="highlighter-rouge">[beta]</code> (so
reviewers can see its specialness). The OP of that PR should contain
links to all the PRs being backported. <a href="https://github.com/rust-lang/rust/pull/36634">Here’s an
example</a>. Anybody can
make these PRs!</p>

<p>After that a reviewer needs to verify that the backport looks correct,
that it’s submitted to the beta branch, and then approve via <code class="highlighter-rouge">@bors: r+</code>.
Finally, they need to follow the links to the original PRs and <em>remove the
<code class="highlighter-rouge">beta-nominated</code> tag</em> (people forget to do this a lot). This last step indicates
that the backport has been completed, so the <code class="highlighter-rouge">beta-nominated</code> and
<code class="highlighter-rouge">beta-accepted</code> tags have three states.</p>

<h2 id="backporting-in-rust-langcargo">Backporting in <code class="highlighter-rouge">rust-lang/cargo</code></h2>

<p>The procedure for backporting fixes to Cargo is similar but slightly more
extended than the <code class="highlighter-rouge">rust-lang/rust</code> repo’s procedure. Currently there aren’t
backport tags in the Cargo repository, but you’ll initiate the backport process
by commenting on an associated PR, requesting a backport. Once a Cargo team
member has approved the backport to happen you’re good to start sending PRs!</p>

<ul>
  <li>
    <p>First you’ll send a PR to the <code class="highlighter-rouge">rust-1.21.0</code> branch of Cargo (replace 1.21 with
the current rustc beta version number). Like with <code class="highlighter-rouge">rust-lang/rust</code> you’ll
prefix the title of your PR with <code class="highlighter-rouge">[beta]</code> and ensure it’s flagged as going to
beta.</p>
  </li>
  <li>
    <p>Next a Cargo reviewer will <code class="highlighter-rouge">@bors: r+</code> the PR and put it into the queue.
Eventually bors will automatically merge the PR (when tests are passing) to
the appropriate Cargo branch.</p>
  </li>
  <li>
    <p>Finally you’ll send a PR to the <code class="highlighter-rouge">rust-lang/rust</code> repository’s <code class="highlighter-rouge">beta</code> branch,
updating the Cargo submodule. The Cargo submodule should be updated to the tip
of the <code class="highlighter-rouge">rust-1.21.0</code> branch (the branch your Cargo PR was merged to). As like
before, ensure you’ve got <code class="highlighter-rouge">[beta]</code> in the PR title.</p>
  </li>
</ul>

<p>After that’s all said and done the Cargo change is ready to get scheduled onto
the beta release!</p>
</div>

  </body>
</html>
